\chapter{Data}

Our main source of data is the Cantus database (\cite{cantus_db}), one of the databases indexed in the Cantus Index. The database serves as a 
digital archive of chants, each entry containing information about its source, liturgical occasion, mode, and others. Work on the project started
in the late 1980s, and to date, around 500,000 individual chants from approximately 150 manuscripts have been indexed. Each entry is transcribed 
manually and undergoes a thorough examination before publishing (\cite{cantus_lacoste}).

We are using a scraped version of the Cantus database released as CantusCorpus (\cite(chant21)). Unlike the Cantus database which is continuously being
updated and is therefore unsuitable for computational study, the corpus is versioned, therefore each version always contains the same data. We are using
version 0.2 released in July 2020 which contains 497071 entries. The corpus is available for download in CSV format.

\section{CSV}

CSV is one of the most common formats for tabular data. The abbreviation stands for \emph{comma-separated values}. As the name suggests, the format
uses commas to separate columns (although other separators, such as a semicolon, can be used as well to allow for simpler parsing in case that the data 
frequently contains commas that would otherwise need to be escaped), while the individual rows are separated by a line break. The data is stored as plaintext,
which makes it easily readable. Parsing CSV files becomes more complicated when the data contains column and row separators inside fields; in that case
quotation marks or esape sign has to be used. There exist many well-designed parsers, one such parser is the Python module simply called \emph{csv}.
This application uses the module \emph{pandas} to parse CSV files, which in turn uses the \emph{csv} module.

\section{Database fields}

The following table represents the data fields in the database.

\begin{longtable}{| p{.25\textwidth} | p{.75\textwidth} |} 
%\begin{center}
%\begin{tabular}{| c | c |} 

 \hline
 Data field & Description \\
 \hline
 id & automatically generated id in the database \\ \hline
 corpus\_id & human-readable id identifying the chant in the CantusCorpus \\ \hline
 incipit & incipit (the first few words) of chant \\ \hline
 cantus\_id & id identifying the chant in the Cantus Index \\ \hline
 mode & mode of the chant \\ \hline
 finalis & the final note of the chant \\ \hline
 differentia & FILL IN \\ \hline
 siglum & FILL IN \\ \hline
 position & liturgical role of the chant \\ \hline
 folio & page of the manuscript where the chant is found \\ \hline
 sequence & order in which the chant is found in the folio \\ \hline
 marginalia & clarification about the location of the chant \\ \hline
 cao\_concordances & FILL IN \\ \hline
 feast\_id & id of feast \\ \hline
 genre\_id & id of genre \\ \hline
 office\_id & id of office \\ \hline
 source\_id & id of source \\ \hline
 melody\_id & id of melody by which it can be found in the Cantus Index \\ \hline
 drupal\_path & URL of the chant on the Cantus database website \\ \hline
 full\_text & full text in a standardized spelling \\ \hline
 full\_text\_manuscript & full text in the manuscript spelling \\ \hline
 volpiano & transcription of the melody \\ \hline
 notes & indexing notes \\
 \hline

%\end{tabular}
%\end{center}
\caption{List of database fields}
\end{longtable}

\section{User-defined data}

The application enables user to upload their own dataset. In doing so, the user should upload a CSV file with the fields described above, with
some clarifications:

\begin{itemize}
    \item \emph{corpus\_id} is a name invented for this application. The original CSV file has this column listed as \emph{id} and
        to maintain consistency, so should every user-defined file.
    \item The column \emph{id} in this application is generated on data upload. This column should not be present in the uploaded
        data.
    \item There can optionally be an unnamed column in the first position that will be dropped. It is so in case the user generates
        data from a database and doesn't remove its original ids.
    \item The fields \emph{full\_text} and \emph{volpiano} should contain data, as it is the main purpose of the application. Other
        fields may be left empty.
\end{itemize}

\section{Volpiano}

The melodies in the volpiano fields are encoded as strings of alphanumeric characters and dashes. These can be rendered as musical notation using
the volpiano font. Each character represents either a pitch, empty space, or other musical characters, such as a clef.

Volpiano was developed as a research tool optimized for databases and word processors. There are strict rules concerning the transcription, which leads
to all volpiano-encoded melodies having a standardized format. Each transcription begins with a treble clef. Gaps between words are encoded as three
dashes, while two dashes represent gaps between syllables (\cite{volpiano}).

\section{Data cleaning}

